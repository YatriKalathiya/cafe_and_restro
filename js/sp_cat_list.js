// -------------------------------category list js ------------------------------->


var cat_list_data = [
    {
        img: '../shweta_img/img4.png',
        title: 'Samosa',
        cat: 'South India',
        type: 'non veg',
        rate: '4.7',
        des: 'Lorem ipsum dolor sit amet, consectetur adipisicing elit. Totam, eaque quia eius maiores, alias eligendi fuga iure sit commodi aliquid consequatur amet odio error deleniti, dolor exercitationem iste a. Ipsa!',
        price: '$ 120',
        types: [{ title: 'Regular', price: '$10' }, { title: 'Butter', price: '$14' }, { title: 'Cheese', price: '$18' }],
        stuffings: [{ title: 'Palack', price: '$10' }, { title: 'Paneer', price: '00' }],
        dips: [{ title: 'Green chutney', price: '$3' }, { title: 'Ketchup', price: '$3' }, { title: 'Dahi rayta', price: '$3' }],
        sub_cat: 'Samosa',
        main_cat: 'Indian',
        icon: '../shweta_img/veg.svg'
    },
    {
        img: '../shweta_img/img4.png',
        title: 'Pizza',
        cat: 'South India',
        type: 'pure veg',
        rate: '4.7',
        des: 'Lorem ipsum dolor sit amet, consectetur adipisicing elit. Totam, eaque quia eius maiores, alias eligendi fuga iure sit commodi aliquid consequatur amet odio error deleniti, dolor exercitationem iste a. Ipsa!',
        price: '$ 120',
        types: [{ title: 'Regular', price: '$10' }, { title: 'Butter', price: '$14' }, { title: 'Cheese', price: '$18' }],
        stuffings: [{ title: 'Palack', price: '$10' }, { title: 'Paneer', price: '00' }],
        dips: [{ title: 'Green chutney', price: '$3' }, { title: 'Ketchup', price: '$3' }, { title: 'Dahi rayta', price: '$3' }],
        sub_cat: 'Pizza',
        main_cat: 'Indian',
        icon: '../shweta_img/nonVeg.png'
    },
    {
        img: '../shweta_img/img4.png',
        title: 'Pizza',
        cat: 'South India',
        type: 'pure veg',
        rate: '4.7',
        des: 'Lorem ipsum dolor sit amet, consectetur adipisicing elit. Totam, eaque quia eius maiores, alias eligendi fuga iure sit commodi aliquid consequatur amet odio error deleniti, dolor exercitationem iste a. Ipsa!',
        price: '$ 120',
        types: [{ title: 'Regular', price: '$10' }, { title: 'Butter', price: '$14' }, { title: 'Cheese', price: '$18' }],
        stuffings: [{ title: 'Palack', price: '$10' }, { title: 'Paneer', price: '$5' }],
        dips: [{ title: 'Green chutney', price: '$3' }, { title: 'Ketchup', price: '$3' }, { title: 'Dahi rayta', price: '$3' }],
        sub_cat: 'Pizza',
        main_cat: 'Indian',
        icon: '../shweta_img/veg.svg'
    },
    {
        img: '../shweta_img/img4.png',
        title: 'Masala Dosa',
        cat: 'South India',
        type: 'pure veg',
        rate: '4.7',
        des: 'Lorem ipsum dolor sit amet, consectetur adipisicing elit. Totam, eaque quia eius maiores, alias eligendi fuga iure sit commodi aliquid consequatur amet odio error deleniti, dolor exercitationem iste a. Ipsa!',
        price: '$ 120',
        types: [{ title: 'Regular', price: '$10' }, { title: 'Butter', price: '$14' }, { title: 'Cheese', price: '$18' }],
        stuffings: [{ title: 'Palack', price: '$10' }, { title: 'Paneer', price: '$5' }],
        dips: [{ title: 'Green chutney', price: '$3' }, { title: 'Ketchup', price: '$3' }, { title: 'Dahi rayta', price: '$3' }],
        sub_cat: 'Dosa',
        main_cat: 'Indian',
        icon: '../shweta_img/veg.svg'
    },
    {
        img: '../shweta_img/img4.png',
        title: 'Masala Dosa',
        cat: 'South India',
        type: 'non veg',
        rate: '4.7',
        des: 'Lorem ipsum dolor sit amet, consectetur adipisicing elit. Totam, eaque quia eius maiores, alias eligendi fuga iure sit commodi aliquid consequatur amet odio error deleniti, dolor exercitationem iste a. Ipsa!',
        price: '$ 120',
        types: [{ title: 'Regular', price: '$10' }, { title: 'Butter', price: '$14' }, { title: 'Cheese', price: '$18' }],
        stuffings: [{ title: 'Palack', price: '$10' }, { title: 'Paneer', price: '$5' }],
        dips: [{ title: 'Green chutney', price: '$3' }, { title: 'Ketchup', price: '$3' }, { title: 'Dahi rayta', price: '$3' }],
        sub_cat: 'Dosa',
        main_cat: 'Indian',
        icon: "../shweta_img/veg.svg"
    },
    {
        img: '../shweta_img/img4.png',
        title: 'Masala Dosa',
        cat: 'South India',
        type: 'pure veg',
        rate: '4.7',
        des: 'Lorem ipsum dolor sit amet, consectetur adipisicing elit. Totam, eaque quia eius maiores, alias eligendi fuga iure sit commodi aliquid consequatur amet odio error deleniti, dolor exercitationem iste a. Ipsa!',
        price: '$ 120',
        types: [{ title: 'Regular', price: '$10' }, { title: 'Butter', price: '$14' }, { title: 'Cheese', price: '$18' }],
        stuffings: [{ title: 'Palack', price: '$10' }, { title: 'Paneer', price: '$3' }],
        dips: [{ title: 'Green chutney', price: '$3' }, { title: 'Ketchup', price: '$3' }, { title: 'Dahi rayta', price: '$3' }],
        sub_cat: 'Dosa',
        main_cat: 'Indian',
        icon: '../shweta_img/nonVeg.png'
    },
    {
        img: '../shweta_img/img4.png',
        title: 'Masala Dosa',
        cat: 'South India',
        type: 'pure veg',
        rate: '4.7',
        des: 'Lorem ipsum dolor sit amet, consectetur adipisicing elit. Totam, eaque quia eius maiores, alias eligendi fuga iure sit commodi aliquid consequatur amet odio error deleniti, dolor exercitationem iste a. Ipsa!',
        price: '$ 120',
        types: [{ title: 'Regular', price: '$10' }, { title: 'Butter', price: '$14' }, { title: 'Cheese', price: '$18' }],
        stuffings: [{ title: 'Palack', price: '$10' }, { title: 'Paneer', price: '$9' }],
        dips: [{ title: 'Green chutney', price: '$3' }, { title: 'Ketchup', price: '$3' }, { title: 'Dahi rayta', price: '$3' }],
        sub_cat: 'Dosa',
        main_cat: 'Indian',
        icon: '../shweta_img/nonVeg.png'
    }
    ,
    {
        img: '../shweta_img/img4.png',
        title: 'Masala Dosa',
        cat: 'South India',
        type: 'pure veg',
        rate: '4.7',
        des: 'Lorem ipsum dolor sit amet, consectetur adipisicing elit. Totam, eaque quia eius maiores, alias eligendi fuga iure sit commodi aliquid consequatur amet odio error deleniti, dolor exercitationem iste a. Ipsa!',
        price: '$ 120',
        types: [{ title: 'Regular', price: '$10' }, { title: 'Butter', price: '$14' }, { title: 'Cheese', price: '$18' }],
        stuffings: [{ title: 'Palack', price: '$10' }, { title: 'Paneer', price: '$6' }],
        dips: [{ title: 'Green chutney', price: '$3' }, { title: 'Ketchup', price: '$3' }, { title: 'Dahi rayta', price: '$3' }],
        sub_cat: 'Dosa',
        main_cat: 'Indian',
        icon: '../shweta_img/nonVeg.png'
    }
    ,
    {
        img: '../shweta_img/img4.png',
        title: 'Masala Dosa',
        cat: 'South India',
        type: 'pure veg',
        rate: '4.7',
        des: 'Lorem ipsum dolor sit amet, consectetur adipisicing elit. Totam, eaque quia eius maiores, alias eligendi fuga iure sit commodi aliquid consequatur amet odio error deleniti, dolor exercitationem iste a. Ipsa!',
        price: '$ 120',
        types: [{ title: 'Regular', price: '$10' }, { title: 'Butter', price: '$14' }, { title: 'Cheese', price: '$18' }],
        stuffings: [{ title: 'Palack', price: '$10' }, { title: 'Paneer', price: '$9' }],
        dips: [{ title: 'Green chutney', price: '$3' }, { title: 'Ketchup', price: '$3' }, { title: 'Dahi rayta', price: '$3' }],
        sub_cat: 'Dosa',
        main_cat: 'Indian',
        icon: '../shweta_img/veg.svg'
    }
];
var item;

function cat_list(x) {
    var cards;
    var selected_cat = localStorage.getItem('selected_cat');

    var category = cat_list_data.filter(item => item.sub_cat === selected_cat);


    var id = document.getElementById('s_catlist_card');
    id.innerHTML = '';
    if (x == 'pure veg' || x == 'non veg') {
        cards = category.filter(item => item.type === x);
    }
    else if (x == undefined || x == 'all') {
        cards = category;
    }
    cards.forEach((el, index) => {
        const itemHtml = `
            <div class="col-xl-3 col-lg-4 col-sm-6 py-4 d-flex justify-content-start gx-4">
                <div class="s_catlist_card m-xxl-0  mx-auto">
                    <div class="s_catlist_img">
                        <img src="/sujal_img/${el.img}" class="w-100">
                        ${el.type === 'pure veg' ? `<img src="/sujal_img/veg.png" class="s_catlist_icon">` : `<img src="/sujal_img/nonveg.png" class="s_catlist_icon">`}
                    </div>
                    <div class="p-3">
                        <h5>${el.title}</h5>
                        <div>
                            <small class="d-flex text-secondary sp_card_detail ">
                                ${el.cat}
                                <ul class="d-flex ps-0 mb-1">
                                    <li class="ms-3"><span class="mx-1">${el.type}</span></li>
                                    <li class="ms-3"><img src="/sujal_img/star.png" class="mx-1 align-self-center mb-1"><span>${el.rate}</span></li>
                                </ul>
                            </small>
                            <p class="sp_fs_12">${el.des}</p>
                        </div>
                        <div class="d-flex align-items-center justify-content-between">
                            <h4 class="sp_color_yellow">${el.price}</h4>
                            <button type="button" class="s_add_btn" data-bs-toggle="modal" data-bs-target="#exampleModal${index}" >Add</button>

                            <div class="modal fade" id="exampleModal${index}" tabindex="-1" aria-labelledby="exampleModalLabel${index}" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                                    <div class="modal-content">
                                        <button type="button" class="btn-close ms-auto text-white mb-0" data-bs-dismiss="modal"></button>
                                        <h5 class="modal-title text-center pb-4" id="exampleModalLabel${index}">Customize As Per Your Taste</h5>
                                        <div class="modal-body pt-0 mt-0">
                                            <div class="s_modal_inner">
                                                <small>
                                                    <p class="s_modal_inp">Add Instructions</p>
                                                    <hr>
                                                    <textarea class="s_modal_inp s_modal_intxt" rows="2" placeholder="Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatum praesentium ex numquam perferendis incidunt quas tempore repellendus qui unde cum, reprehenderit adipisci nam. "></textarea>
                                                </small>
                                            </div>
                                            <div class="s_modal_inner">
                                                <h5 class="s_modal_inp">${el.size ? 'Size' : 'Types'}</h5>
                                                <hr>
                                                <ul class="list-unstyled s_modal_inp">
                                                    ${(el.size || el.types).map((option, i) => `
                                                        <li class="d-flex justify-content-between align-items-center py-2">
                                                            <label for="option-${index}-${i}" class="size-label">${option.title}</label>
                                                            <div class="radio-wrapper d-flex justify-content-center">
                                                                <p class="ms-auto mb-0 px-3 text-secondary">+${option.price}</p>
                                                                <input id="option-${index}-${i}" class="radio-input" type="radio" name="${el.size ? 'size' : 'type'}" value="${option.title}">
                                                                <label for="option-${index}-${i}" class="radio-label"></label>
                                                            </div>
                                                        </li>
                                                    `).join('')}
                                                </ul>
                                            </div>
                                            <div class="s_modal_inner">
                                                <h5 class="s_modal_inp">Stuffings</h5>
                                                <hr>
                                                <ul class="list-unstyled s_modal_inp">
                                                    ${el.stuffings ? `
                                                    ${el.stuffings.map((ele, idn) => {
            return `<li class="d-flex justify-content-between align-items-center py-2"><p class="mb-0">${ele.title}</p>
                                                        <div class="">
                                                            <div class="d-flex align-items-center">
                                                                <p class="ms-auto mb-0 px-3 text-secondary">+${ele.price}</p>
                                                                <input type="checkbox" name="Stuffings" value="${ele.title}">
                                                            </div>
                                                        </div>
                                                    </li>`
        }).join('')}
                                                        `: ''}
                                                    
                                                    
                                                </ul>
                                            </div>
                                            <div class="s_modal_inner">
                                                <h5 class="s_modal_inp">Dips</h5>
                                                <hr>
                                              <ul class="list-unstyled s_modal_inp">
                                                    ${el.dips ? `
                                                    ${el.dips.map((ele, idn) => {
            return `<li class="d-flex justify-content-between align-items-center py-2"><p class="mb-0">${ele.title}</p>
                                                            <div class="">
                                                                <div class="d-flex align-items-center">
                                                                    <p class="ms-auto mb-0 px-3 text-secondary">+${ele.price}</p>
                                                                    <input type="checkbox" name="Dips" value="${ele.title}">
                                                                </div>
                                                            </div>
                                                        </li>`
        }).join('')}
                                                    `: ''}
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="sp_modal_footer">
                                            <div class="sp_btn d-flex justify-content-around align-items-center">
                                                <h5 class="mb-0" onclick="adjustItemCount(${index}, -1)" type="button">-</h5>
                                                <h5 class="mb-0" id="no_items_${index}" type="button">1</h5>
                                                <h5 class="mb-0" onclick="adjustItemCount(${index}, 1)" type="button">+</h5>
                                            </div>
                                            <div class="sp_btn d-flex justify-content-around align-items-center" type="button">
                                                 <a href="./Cart.html"> <h5 class="mb-0" onclick="addItemToCart(${index})">Add Item</h5></a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>`;
        id.innerHTML += itemHtml;
    });

}

function no_item(x) {
    if (x == '1' && item > 0) {
        item--;
    } else if (x == '2') {
        item++;
    }
    var id = document.getElementById('no_items');
    id.innerHTML = item;
}
function adjustItemCount(index, change) {
    const countElement = document.getElementById(`no_items_${index}`);
    let count = parseInt(countElement.textContent);
    count = Math.max(1, count + change);
    countElement.textContent = count;
}

function addItemToCart(index) {
    const item = cat_list_data[index];
    const count = parseInt(document.getElementById(`no_items_${index}`).textContent);

    let selectedSize = null;
    let selectedType = null;

    // if (item.size) {
    //     const sizeInput = document.querySelector(`#exampleModal${index} input[name="size"]:checked`);
    //     if (sizeInput) {
    //         selectedSize = sizeInput.value;
    //     } else {
    //         console.warn("No size selected");
    //     }
    // }
    
    if (item.types) {
        const typeInput = document.querySelector(`#exampleModal${index} input[name="type"]:checked`);
        if (typeInput) {
            selectedType = typeInput.value;
        } else {
            console.warn("No type selected");
        }
    }
    

    if (item.types) {
        const typeInput = document.querySelector(`#exampleModal${index} input[name="type"]:checked`);
        if (typeInput) {
            selectedType = typeInput.value;
            // console.log("Selected Type:", selectedType);           
        }
    }

    const stuffings = Array.from(document.querySelectorAll(`#exampleModal${index} input[name="Stuffings"]:checked`)).map(el => el.value);
    const dips = Array.from(document.querySelectorAll(`#exampleModal${index} input[name="Dips"]:checked`)).map(el => el.value);
    const instructions = document.querySelector(`#exampleModal${index} textarea`).value;

    let basePrice = parseFloat(item.price.replace('$', ''));
    let extraPrice = 0;

    // Calculate extra price for size
    if (selectedSize && item.size) {
        const sizeOption = item.size.find(option => option.title === selectedSize);
        if (sizeOption) {
            extraPrice += parseFloat(sizeOption.price.replace('$', ''));
        }
    }

    // Calculate extra price for type
    if (selectedType && item.types) {
        const typeOption = item.types.find(t => t.title === selectedType);
        if (typeOption) {
            extraPrice += parseFloat(typeOption.price.replace('$', ''));
        }
    }

    // Calculate extra price for stuffings and dips
    stuffings.forEach(stuff => {
        const stuffOption = item.stuffings.find(s => s.title === stuff);
        if (stuffOption) {
            extraPrice += parseFloat(stuffOption.price.replace('$', ''));
        }
    });

    dips.forEach(dip => {
        const dipOption = item.dips.find(d => d.title === dip);
        if (dipOption) {
            extraPrice += parseFloat(dipOption.price.replace('$', ''));
        }
    });

    const totalPrice = (basePrice + extraPrice) * count;

    const cartItem = {
        title: item.title,
        count: count,
        size: selectedSize,
        type: selectedType,
        stuffings: stuffings,
        dips: dips,
        instructions: instructions,
        basePrice: basePrice,
        extraPrice: extraPrice,
        totalPrice: totalPrice,
        img: item.img,
        itemType: item.type,
        cat: item.cat,
        rate: item.rate,
        des: item.des,
        main_cat: item.main_cat,
        sub_cat: item.sub_cat,
        icon: item.icon
    };

    console.log("Added to cart:", cartItem);

    // Save to localStorage
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    cart.push(cartItem);
    alert("add to cart")
    localStorage.setItem('cart', JSON.stringify(cart));

}

// --------------------------window onload functions---------------------------------
window.onload = function () {
    item = 1;
    cat_list();
};
